<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sentiment Index Evaluation</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@1.0.0"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-zoom/1.1.1/chartjs-plugin-zoom.min.js"></script>
</head>
<body>
    <header>
        <h1>Stock Prediction Project</h1>
    </header>
    <nav>
        <button id="nav-toggle" onclick="toggleNav()">â˜°</button>
        <ul id="nav-list">
            <li><a href="{{ url_for('home') }}">Home</a></li>
            <li><a href="{{ url_for('about') }}">About</a></li>
            <li><a href="{{ url_for('contact') }}">Contact</a></li>
        </ul>
    </nav>
    <main>
        <section id="intro">
            <h2>Introduction</h2>
            <p>This project displays the impact of sentiment on Tesla stock.<br>
            The below plot displays the predicted stock price of Tesla (TSLA) using <br>
                the last 6 months of stock and sentiment dating from YFinance and Alpha Vantage. <br>
                The 6 months of data are used in a Long Short Term Memory neural network to produce
                a price prediction using stock data only and stock data combined with normalized sentiment data. <br>
                Notice: This is a prediction generated by artificial intelligence. It is not investment advice.
            </p>
        </section>
        <section id="plot-section">
            <h2>Plot</h2>
            <p>Click a selector to remove it from the chart. </p>
            <canvas id="plotCanvas" width="400" height="200"></canvas>
        </section>
        <!-- Statistics Section -->
        <section id="stats-section">
            <h2>Model Statistics</h2>
            <div id="stats">
    <p><strong>Combined Model Accuracy:</strong> ${combinedModelStats.accuracy}
    <br><small>Indicates the closeness of the model's predictions to actual values. Higher is better, with a maximum of 1.</small></p>

    <p><strong>Combined Model Mean Squared Error:</strong> ${combinedModelStats.mean_squared_error}
    <br><small>Measures the average error in the model's predictions. Lower is better.</small></p>

    <p><strong>Stock Only Model Accuracy:</strong> ${stockOnlyModelStats.accuracy}
    <br><small>Indicates the closeness of the stock-only model's predictions to actual values. Higher is better, with a maximum of 1.</small></p>

    <p><strong>Stock Only Model Mean Squared Error:</strong> ${stockOnlyModelStats.mean_squared_error}
    <br><small>Measures the average error in the stock-only model's predictions. Lower is better.</small></p>
</div>
        </section>
    </main>
    <footer>
        <p>&copy; 2023, Stock Prediction Project</p>
    </footer>

    <script>
        fetch('/get_plot_data')
        .then(response => response.json())
        .then(data => {
            const plotDataList = data.plot_data;
            const combinedModelStats = data.combined_model_statistics;
            const stockOnlyModelStats = data.stock_only_model_statistics;

            const ctx = document.getElementById('plotCanvas').getContext('2d');
const myChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: plotDataList.map(data => moment(data.date).toDate()),
        datasets: [
            {
                label: 'Actual',
                data: plotDataList.map(data => data.actual),
                borderColor: 'rgb(75, 192, 192)',
                tension: 0.1
            },
            {
                label: 'Predicted with Sentiment',
                data: plotDataList.map(data => data.predicted_with_sentiment),
                borderColor: 'rgb(255, 99, 132)',
                tension: 0.1
            },
            {
                label: 'Predicted Stock Only',
                data: plotDataList.map(data => data.predicted_stock_only),
                borderColor: 'rgb(54, 162, 235)',
                tension: 0.1
            }
        ]
    },
    options: {
        scales: {
            x: {
                type: 'time',
                time: {
                    unit: 'day',
                    tooltipFormat: 'll'
                },
                title: {
                    display: true,
                    text: 'Date'
                }
            },
            y: {
                beginAtZero: true,
                title: {
                    display: true,
                    text: 'Stock Value (USD $)'
                }
            }
        },
        plugins: {
            zoom: {
                pan: {
                    enabled: true,
                    mode: 'x'
                },
                zoom: {
                    wheel: {
                        enabled: true,
                    },
                    pinch: {
                        enabled: true
                    },
                    mode: 'x'
                }
            }
        }
    }
});
            // Update the stats section
            const statsSection = document.getElementById('stats');
            statsSection.innerHTML = `
                <p><strong>Combined Model Accuracy:</strong> ${combinedModelStats.accuracy}</p>
                <p><strong>Combined Model Mean Squared Error:</strong> ${combinedModelStats.mean_squared_error}</p>
                <p><strong>Stock Only Model Accuracy:</strong> ${stockOnlyModelStats.accuracy}</p>
                <p><strong>Stock Only Model Mean Squared Error:</strong> ${stockOnlyModelStats.mean_squared_error}</p>
            `;
        });

        function toggleNav() {
            const navList = document.getElementById('nav-list');
            if (navList.style.display === 'block') {
                navList.style.display = 'none';
            } else {
                navList.style.display = 'block';
            }
        }
    </script>
</body>
</html>
